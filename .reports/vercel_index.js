const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/LoginPage-B-T9pPJV.js","assets/vendor-C6sppUJG.js","assets/button-gthWedU-.js","assets/ui-HHog8Wtb.js","assets/input-hSNXqCAi.js","assets/interaction-EupjOfc9.js","assets/icons-DqnRitTf.js","assets/state-data-DWZn3r-Y.js","assets/DashboardPage-BgfHRYWq.js","assets/robustMapsApi-oBCqvmKp.js","assets/NeuralMapEditorPage-D37jK9am.js","assets/xyflow-BFHZLSqF.js","assets/xyflow-BZV40eAE.css","assets/advanced-save-queue-4n-dj-Rp.js","assets/robustMapDelete-DZIrfIuJ.js","assets/KanbanPage-BKKd0GTi.js","assets/NotFoundPage-CrDFmOJw.js","assets/MapsPage-CsqiSI5B.js","assets/TasksPage-B4p1IZRf.js","assets/ProfilePage-D3do1lGl.js"])))=>i.map(i=>d[i]);
import{r as u,j as s,L as be,M as ve,N as K,O as le,P as ee,Q as ce,R as de,S as ue,T as je,U as Ne,V as E,W as Q,X as Se,Y as _e,Z as Ee,$ as Ce,a0 as Ae}from"./vendor-C6sppUJG.js";import{a as Oe,b as Re}from"./state-data-DWZn3r-Y.js";import{C as Le,R as Pe,U as V,B as ke,a as me,b as Ie,L as Te,M as Y,c as Me,H as $e,S as te,X as De,d as Ue,N as ze,e as Fe}from"./icons-DqnRitTf.js";import{m as A,A as k}from"./interaction-EupjOfc9.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(n){if(n.ep)return;n.ep=!0;const l=r(n);fetch(n.href,l)}})();const Je="modulepreload",Be=function(t){return"/"+t},se={},R=function(e,r,a){let n=Promise.resolve();if(r&&r.length>0){let m=function(h){return Promise.all(h.map(f=>Promise.resolve(f).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),i=o?.nonce||o?.getAttribute("nonce");n=m(r.map(h=>{if(h=Be(h),h in se)return;se[h]=!0;const f=h.endsWith(".css"),y=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${y}`))return;const c=document.createElement("link");if(c.rel=f?"stylesheet":Je,f||(c.as="script"),c.crossOrigin="",c.href=h,i&&c.setAttribute("nonce",i),document.head.appendChild(c),f)return new Promise((N,C)=>{c.addEventListener("load",N),c.addEventListener("error",()=>C(new Error(`Unable to preload CSS for ${h}`)))})}))}function l(o){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=o,window.dispatchEvent(i),!i.defaultPrevented)throw o}return n.then(o=>{for(const i of o||[])i.status==="rejected"&&l(i.reason);return e().catch(l)})};class qe{logs=[];maxLogs=1e3;log(e,r,a){const n=new Date().toISOString(),l={level:e,timestamp:n,message:r,data:a};this.logs.push(l),this.logs.length>this.maxLogs&&this.logs.shift(),this.getPrefix(e);try{const o=localStorage.getItem("mindmap_logs"),i=o?JSON.parse(o):[];i.push(l),i.length>500&&i.shift(),localStorage.setItem("mindmap_logs",JSON.stringify(i))}catch{}}getPrefix(e){return`[${{debug:"🔍",info:"ℹ️",warn:"⚠️",error:"❌"}[e]} ${e.toUpperCase()}]`}debug(e,r){this.log("debug",e,r)}info(e,r){this.log("info",e,r)}warn(e,r){this.log("warn",e,r)}error(e,r){r instanceof Error?this.log("error",e,{message:r.message,stack:r.stack,name:r.name}):this.log("error",e,r)}getLogs(){return this.logs}getRecentLogs(e=20){return this.logs.slice(-e)}getErrorLogs(){return this.logs.filter(e=>e.level==="error"||e.level==="warn")}clearLogs(){this.logs=[];try{localStorage.removeItem("mindmap_logs")}catch{}}exportLogs(){return JSON.stringify(this.logs,null,2)}downloadLogs(){const e=this.exportLogs(),r=new Blob([e],{type:"application/json"}),a=URL.createObjectURL(r),n=document.createElement("a");n.href=a,n.download=`mindmap-logs-${Date.now()}.json`,n.click(),URL.revokeObjectURL(a)}}const I=new qe,Ke="https://mvkrlvjyocynmwslklzu.supabase.co",Ve="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im12a3Jsdmp5b2N5bm13c2xrbHp1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk3MjYzMTksImV4cCI6MjA4NTMwMjMxOX0.WDM7ZVVoGmi54T3aBGONWhSzgTvWHeS-ZzARg6q4eAc",U=Oe(Ke,Ve,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!1},realtime:{params:{eventsPerSecond:10}},global:{headers:{"x-client-info":"mindmap-hub@1.0.0"}}});U.auth.getSession().then(()=>{}).catch(t=>{});const We=async()=>{try{const{data:{session:t},error:e}=await U.auth.getSession();return e?null:t}catch{return null}},He=async()=>{try{return(await We())?.access_token||null}catch{return null}},Ge="https://mindmap-hub-api.onrender.com",Ye=2,Xe=500;function Qe(t){const e=t.replace(/-/g,"+").replace(/_/g,"/"),r=(4-e.length%4)%4,a=`${e}${"=".repeat(r)}`;if(typeof atob=="function")return atob(a);if(typeof Buffer<"u")return Buffer.from(a,"base64").toString("utf8");throw new Error("No base64 decoder available")}function Ze(t){let e=2166136261;for(let r=0;r<t.length;r+=1)e^=t.charCodeAt(r),e=e+(e<<1)+(e<<4)+(e<<7)+(e<<8)+(e<<24)>>>0;return e.toString(16).padStart(8,"0")}function et(t){try{const e=t.split(".");if(e.length<2)return null;const r=Qe(e[1]),a=JSON.parse(r),n=a?.sub??a?.user_id??a?.id;return typeof n=="string"&&n.length>0?n:null}catch{return null}}function tt(t){if(!t)return null;const e=String(t);if(!e.toLowerCase().startsWith("bearer "))return null;const r=e.slice(7).trim();if(!r)return null;const a=et(r);return a?`uid:${a}`:`tok:${Ze(r)}`}class st{baseUrl;requestCache=new Map;cacheTimeout=300*1e3;constructor(e){this.baseUrl=e}async getAuthHeaders(){const e={};try{const r=await He();r&&(e.Authorization=`Bearer ${r}`)}catch{}return e}sleep(e){return new Promise(r=>setTimeout(r,e))}getCacheKey(e,r,a,n=null){return a&&r==="GET"?`${this.baseUrl}${e}${n?`::${n}`:""}`:null}invalidateCache(){this.requestCache.clear()}clearCache(){this.invalidateCache()}async fetch(e,r={}){const{authenticated:a=!0,retries:n=Ye,useCache:l=!0,...o}=r,i=(o.method||"GET").toUpperCase(),m=a?await this.getAuthHeaders():{},h=a?tt(m.Authorization):null,f=this.getCacheKey(e,i,l,h);if(f&&i==="GET"){const c=this.requestCache.get(f);if(c&&Date.now()-c.timestamp<this.cacheTimeout)return c.data}const y={"Content-Type":"application/json"};a&&Object.assign(y,m),o.headers&&Object.assign(y,o.headers);try{const c=`${this.baseUrl}${e}`,N=new AbortController,C=setTimeout(()=>N.abort(),1e4),S=await fetch(c,{...o,method:i,headers:y,signal:N.signal});clearTimeout(C);const M=S.headers.get("content-type");let b;if(M?.includes("application/json")?b=await S.json():b=await S.text(),!S.ok){if(S.status===409)return typeof b=="object"?b:{success:!1,error:{code:"CONFLICT",message:"Conflict"}};if(S.status===404)throw new P(typeof b=="object"&&b.error?.message||"Not found","NOT_FOUND",404);const F=typeof b=="object"&&(b.error?.message||b.message)||"Request failed",J=typeof b=="object"&&b.error?.code||"UNKNOWN_ERROR";throw new P(F,J,S.status)}const $=typeof b=="object"?b:{success:!0,data:b};return f&&i==="GET"&&$.success&&this.requestCache.set(f,{data:$,timestamp:Date.now()}),i!=="GET"&&$.success&&this.invalidateCache(),$}catch(c){const N=c instanceof TypeError||c instanceof DOMException&&c.name==="AbortError",C=c instanceof P&&(c.statusCode===0||c.statusCode>=500);if(n>0&&(N||C))return await this.sleep(Xe),this.fetch(e,{...r,retries:n-1});throw c instanceof P?c:c instanceof DOMException&&c.name==="AbortError"?new P("Request timeout - server took too long to respond","TIMEOUT",0):new P("Failed to connect to server. Please check your connection.","NETWORK_ERROR",0)}}async get(e,r){return this.fetch(e,{...r,method:"GET"})}async post(e,r,a){return this.fetch(e,{...a,method:"POST",body:r?JSON.stringify(r):void 0})}async patch(e,r,a){return this.fetch(e,{...a,method:"PATCH",body:r?JSON.stringify(r):void 0})}async put(e,r,a){return this.fetch(e,{...a,method:"PUT",body:r?JSON.stringify(r):void 0})}async delete(e,r){return this.fetch(e,{...r,method:"DELETE"})}}class P extends Error{code;statusCode;constructor(e,r,a){super(e),this.name="ApiError",this.code=r,this.statusCode=a}}const p=new st(Ge),re={listFixedAccounts:()=>p.get("/api/auth/accounts",{authenticated:!1}),getMe:()=>p.get("/api/auth/me"),updateProfile:t=>p.patch("/api/auth/me",t)},he={list:t=>{const e=new URLSearchParams;return t?.workspace_id&&e.set("workspace_id",t.workspace_id),t?.search&&e.set("search",t.search),t?.limit&&e.set("limit",t.limit.toString()),t?.offset&&e.set("offset",t.offset.toString()),p.get(`/api/maps?${e}`,{useCache:!1})},get:(t,e)=>{const r=new URLSearchParams;e?.includeGraph&&r.set("include_graph","true");const a=r.toString();return p.get(`/api/maps/${t}${a?`?${a}`:""}`,{useCache:!1})},create:t=>p.post("/api/maps",t),update:(t,e)=>p.patch(`/api/maps/${t}`,e),delete:t=>p.delete(`/api/maps/${t}`),duplicate:(t,e)=>p.post(`/api/maps/${t}/duplicate`,{title:e})},rt={listByMap:t=>p.get(`/api/nodes/map/${t}`,{useCache:!1}),get:t=>p.get(`/api/nodes/${t}`,{useCache:!1}),create:t=>p.post("/api/nodes",t),update:(t,e)=>p.patch(`/api/nodes/${t}`,e),batchUpdate:t=>p.patch("/api/nodes/batch",{nodes:t}),delete:(t,e=!0)=>p.delete(`/api/nodes/${t}?cascade=${e}`),getEdges:t=>p.get(`/api/nodes/edges/map/${t}`,{useCache:!1}),createEdge:t=>p.post("/api/nodes/edges",t),deleteEdge:t=>p.delete(`/api/nodes/edges/${t}`),deleteEdgeByConnection:t=>{const e=new URLSearchParams({map_id:t.map_id,source_id:t.source_id,target_id:t.target_id});return p.delete(`/api/nodes/edges?${e.toString()}`)},getComments:t=>p.get(`/api/nodes/${t}/comments`),addComment:(t,e,r)=>p.post(`/api/nodes/${t}/comments`,{content:e,mentions:r}),deleteComment:t=>p.delete(`/api/nodes/comments/${t}`)},at={id:"11111111-1111-1111-1111-111111111111",name:"MindLab",slug:"mindlab",role:"member"};function nt(t){const{user:e,workspaces:r}=t||{};if(!e?.id||!e?.email)throw new Error("Invalid /api/auth/me payload");const a={id:String(e.id),email:String(e.email),display_name:String(e.display_name||String(e.email).split("@")[0]||"User"),avatar_url:e.avatar_url??null,color:String(e.color||"#06E5FF"),avatar_id:e.avatar_id},n={id:a.id,email:a.email,display_name:a.display_name,avatar_url:a.avatar_url,color:a.color,avatar_id:a.avatar_id},l=(r||[]).filter(o=>o&&o.id).map(o=>({id:String(o.id),name:String(o.name||"Workspace"),slug:String(o.slug||""),role:String(o.role||"member")}));return{user:a,profile:n,workspaces:l.length>0?l:[at]}}const T=Re()((t,e)=>({user:null,profile:null,workspaces:[],isAuthenticated:!1,isLoading:!1,setFromMe:r=>{const a=nt(r);t({user:a.user,profile:a.profile,workspaces:a.workspaces,isAuthenticated:!0,isLoading:!1}),localStorage.setItem("mindmap_auth_user",JSON.stringify(a.user)),localStorage.setItem("mindmap_auth_profile",JSON.stringify(a.profile))},updateProfile:async r=>{const a=e();if(!a.user)throw new Error("No user logged in");const n=await re.updateProfile({display_name:r.display_name,avatar_url:r.avatar_url});if(!n.success||!n.data)throw new Error(n?.error?.message||"Failed to update profile");const l=n.data.user||n.data,o={...a.user,display_name:l.display_name||a.user.display_name,avatar_url:l.avatar_url!==void 0?l.avatar_url:a.user.avatar_url,color:l.color||a.user.color},i=a.profile?{...a.profile,display_name:o.display_name,avatar_url:o.avatar_url,color:o.color}:null;t({user:o,profile:i}),localStorage.setItem("mindmap_auth_user",JSON.stringify(o)),i&&localStorage.setItem("mindmap_auth_profile",JSON.stringify(i))},initialize:()=>{t({isLoading:!0}),(async()=>{try{const{data:r,error:a}=await U.auth.getSession();if(!a&&r?.session){const n=await re.getMe();if(n.success&&n.data?.user){e().setFromMe(n.data);return}await U.auth.signOut(),p.clearCache()}t({user:null,profile:null,workspaces:[],isAuthenticated:!1,isLoading:!1})}catch{t({user:null,profile:null,workspaces:[],isAuthenticated:!1,isLoading:!1})}})()},signOut:()=>{U.auth.signOut().catch(()=>{}),p.clearCache(),t({user:null,profile:null,workspaces:[],isAuthenticated:!1,isLoading:!1}),localStorage.removeItem("mindmap_auth_user"),localStorage.removeItem("mindmap_auth_profile")}}));function ot(){const{user:t,profile:e}=T(),r=u.useRef(),a=u.useRef(""),n=u.useRef(t),l=u.useRef(e);n.current=t,l.current=e;const o=u.useCallback(m=>m?typeof m!="string"?!1:m.length===0?!0:!(m.length>1e4):!0,[]),i=u.useCallback(()=>{const m=n.current,h=l.current;if(!m)return;const f=JSON.stringify({user:m,profile:h});if(f!==a.current){a.current=f;try{const y=localStorage.getItem("mindmap_auth_user"),c=localStorage.getItem("mindmap_auth_profile");(!y||!c)&&(localStorage.setItem("mindmap_auth_user",JSON.stringify(m)),localStorage.setItem("mindmap_auth_profile",JSON.stringify(h)))}catch{}}},[]);return u.useEffect(()=>(i(),r.current=setInterval(i,5e3),()=>{r.current&&clearInterval(r.current)}),[i]),u.useEffect(()=>{const m=()=>{document.hidden||i()};return document.addEventListener("visibilitychange",m),()=>{document.removeEventListener("visibilitychange",m)}},[i]),{user:t,profile:e,isProfileValid:o(t?.avatar_url)}}class it{activeOverlays=new Set;lastPathname="";constructor(){window.addEventListener("popstate",()=>this.handleNavigationChange())}registerOverlay(e,r){this.activeOverlays.add(`${r}:${e}`)}unregisterOverlay(e,r){this.activeOverlays.delete(`${r}:${e}`)}handleNavigationChange(){const e=window.location.pathname;e!==this.lastPathname&&(this.cleanupAllOverlays(),this.lastPathname=e)}cleanupAllOverlays(){document.querySelectorAll("[data-overlay]").forEach(e=>{const r=window.getComputedStyle(e);if(r.display==="none"||r.pointerEvents==="none"){e.remove();return}const n=e.__createdAt||Date.now();Date.now()-n>3e4&&e.remove()}),document.body.style.overflow==="hidden"&&(document.body.style.overflow=""),document.querySelectorAll("[data-overlay]").length===0&&this.activeOverlays.clear()}forceCloseAll(){document.querySelectorAll("[data-overlay]").forEach(e=>{e.remove()}),document.body.style.overflow="",document.documentElement.style.overflow="",this.activeOverlays.clear()}getStatus(){const e=document.querySelectorAll("[data-overlay]").length;return{activeCount:this.activeOverlays.size,overlays:Array.from(this.activeOverlays),bodyOverflow:document.body.style.overflow||"auto",domOverlays:e}}}const X=new it;function ae(t,e={}){`${t}`,{...e,ts:new Date().toISOString()}}class lt extends u.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return I.error("ErrorBoundary capturou um erro de renderização",e),{hasError:!0,error:e}}componentDidCatch(e,r){I.error("Detalhes do erro capturado pelo ErrorBoundary",{message:e.message,stack:e.stack,componentStack:r.componentStack})}handleReset=()=>{I.info("Resetando ErrorBoundary e recarregando aplicação"),this.setState({hasError:!1,error:null}),window.location.reload()};render(){return this.state.hasError?s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-[#060910]",children:s.jsx("div",{className:"max-w-md w-full mx-auto px-4",children:s.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 rounded-xl p-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx(Le,{className:"w-6 h-6 text-red-500"}),s.jsx("h1",{className:"text-lg font-semibold text-red-400",children:"Algo deu errado"})]}),s.jsx("p",{className:"text-slate-400 text-sm mb-4",children:"Houve um erro ao processar sua solicitação. Tente novamente."}),s.jsx("div",{className:"bg-red-500/5 rounded-lg p-3 mb-4 max-h-24 overflow-auto",children:s.jsx("p",{className:"text-xs text-red-400 font-mono",children:this.state.error?.message||"Unknown error"})}),s.jsxs("button",{onClick:this.handleReset,className:"w-full flex items-center justify-center gap-2 bg-cyan-500 hover:bg-cyan-600 text-white font-medium py-2.5 px-4 rounded-lg transition-colors",children:[s.jsx(Pe,{className:"w-4 h-4"}),"Tentar novamente"]})]})})}):this.props.children}}function L(...t){return be(ve(t))}function ct(t){const e=new Date,r=new Date(t),a=e.getTime()-r.getTime(),n=Math.floor(a/1e3),l=Math.floor(n/60),o=Math.floor(l/60),i=Math.floor(o/24);return n<60?"agora":l<60?`${l}min atrás`:o<24?`${o}h atrás`:i<7?`${i}d atrás`:r.toLocaleDateString("pt-BR",{day:"2-digit",month:"short"})}function pe({url:t,displayName:e="U",size:r="md",className:a=""}){const[n,l]=u.useState(!1),[o,i]=u.useState(!0),m={sm:"w-6 h-6",md:"w-8 h-8",lg:"w-12 h-12"},h={sm:"text-[10px]",md:"text-xs",lg:"text-sm"},f={sm:4,md:4,lg:6},y=e?.charAt(0)?.toUpperCase()||"U",c=!n&&t;return s.jsxs("div",{className:`
        ${m[r]}
        rounded-full flex items-center justify-center flex-shrink-0 overflow-hidden
        bg-gradient-to-br from-cyan-500/25 to-purple-500/25 border border-white/[0.15]
        ${a}
      `,children:[c&&s.jsx("img",{src:t,alt:e,className:"w-full h-full object-cover",onLoad:()=>i(!1),onError:()=>{l(!0),i(!1)},style:{display:o?"none":"block"}}),n&&s.jsx("span",{className:`
            font-bold text-white
            ${h[r]}
          `,children:y}),!t&&s.jsx(V,{className:"text-slate-500",width:f[r],height:f[r]})]})}const dt=[{label:"Dashboard",href:"/dashboard",icon:Te},{label:"Meus Mapas",href:"/maps",icon:Y},{label:"Perfil",href:"/profile",icon:V}];function ut({collapsed:t,onCollapsedChange:e}){const r=K(),a=le(),{user:n,signOut:l}=T(),o=()=>{l(),a("/login"),ce.success("Até logo!",{duration:2500})},i=m=>r.pathname===m||m!=="/dashboard"&&r.pathname.startsWith(m);return s.jsxs(A.aside,{initial:!1,animate:{width:t?72:260},transition:{duration:.25,ease:[.25,.1,.25,1]},className:"relative flex flex-col bg-[#0A0E18]/80 border-r border-white/[0.04] backdrop-blur-xl overflow-hidden",children:[s.jsxs("div",{className:"flex items-center h-[60px] px-4 border-b border-white/[0.04]",children:[s.jsxs(ee,{to:"/dashboard",className:"flex items-center gap-2.5 group",children:[s.jsx("div",{className:"w-9 h-9 rounded-xl bg-gradient-to-br from-cyan-500 to-blue-600 flex items-center justify-center shadow-lg shadow-cyan-500/15 group-hover:shadow-cyan-500/25 transition-shadow flex-shrink-0",children:s.jsx(ke,{className:"w-5 h-5 text-white"})}),s.jsx(k,{children:!t&&s.jsx(A.span,{initial:{opacity:0,x:-8},animate:{opacity:1,x:0},exit:{opacity:0,x:-8},transition:{duration:.15},className:"text-[15px] font-bold text-white tracking-tight whitespace-nowrap",children:"NeuralMap"})})]}),s.jsx("button",{onClick:()=>e(!t),className:L("ml-auto w-7 h-7 rounded-lg flex items-center justify-center text-slate-500 hover:text-white hover:bg-white/[0.06] transition-all flex-shrink-0",t&&"ml-0"),children:t?s.jsx(me,{className:"w-4 h-4"}):s.jsx(Ie,{className:"w-4 h-4"})})]}),s.jsx("nav",{className:"flex-1 px-3 py-4 space-y-1",children:dt.map(m=>{const h=i(m.href),f=m.icon;return s.jsxs(ee,{to:m.href,title:t?m.label:void 0,className:L("group relative flex items-center gap-3 px-3 py-2.5 rounded-xl transition-all duration-200",h?"bg-cyan-500/10 text-cyan-400":"text-slate-400 hover:text-white hover:bg-white/[0.04]"),children:[h&&s.jsx("span",{className:"absolute left-0 top-1/2 -translate-y-1/2 w-[3px] h-5 rounded-r-full bg-cyan-400"}),s.jsx(f,{className:L("w-[18px] h-[18px] flex-shrink-0",h&&"text-cyan-400")}),s.jsx(k,{children:!t&&s.jsx(A.span,{initial:{opacity:0,x:-4},animate:{opacity:1,x:0},exit:{opacity:0,x:-4},transition:{duration:.12},className:"text-[13px] font-medium whitespace-nowrap",children:m.label})})]},m.href)})}),s.jsxs("div",{className:"border-t border-white/[0.04] p-3 space-y-2",children:[s.jsxs("button",{type:"button",onClick:()=>a("/profile"),className:L("w-full flex items-center gap-3 p-2.5 rounded-xl",t&&"justify-center"),title:t?n?.display_name||"Perfil":void 0,children:[s.jsx("div",{className:"flex items-center justify-center",children:n?s.jsx(pe,{url:n.avatar_url,displayName:n.display_name,size:"sm",className:"border border-white/10"}):s.jsx(V,{className:"w-4 h-4 text-slate-400"})}),s.jsx(k,{children:!t&&s.jsx(A.div,{initial:{opacity:0,x:-4},animate:{opacity:1,x:0},exit:{opacity:0,x:-4},transition:{duration:.12},className:"flex-1 min-w-0 text-left",children:s.jsx("p",{className:"text-[13px] font-medium text-white truncate",children:n?.display_name||"Usuário"})})})]}),s.jsxs("button",{onClick:o,className:"w-full flex items-center justify-center gap-2 px-2.5 py-2 rounded-lg text-slate-500 hover:text-red-400 hover:bg-red-500/[0.06] transition-all",title:"Sair",children:[s.jsx(Me,{className:"w-4 h-4"}),s.jsx(k,{children:!t&&s.jsx(A.span,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"text-[12px] font-medium whitespace-nowrap",children:"Sair"})})]})]})]})}const D="mindmap_maps_cache",G="mindmap_maps";class mt{async createMap(e){const r={...e,description:e.description??""},a=await he.create(r);if(!a.success||!a.data)throw new Error("Failed to create map on server");const n=a.data;return I.info("Map created via API:",n.id),n}updateCache(e){try{localStorage.setItem(D,JSON.stringify(e))}catch{}}getCachedMaps(){try{const e=localStorage.getItem(D);if(e)return JSON.parse(e);const r=localStorage.getItem(G);if(r){const a=JSON.parse(r);return localStorage.setItem(D,JSON.stringify(a)),localStorage.removeItem(G),Array.isArray(a)?a:[]}return[]}catch{return[]}}removeFromCache(e){try{const a=this.getCachedMaps().filter(n=>n.id!==e);localStorage.setItem(D,JSON.stringify(a))}catch{}}clearCache(){try{localStorage.removeItem(D),localStorage.removeItem(G)}catch{}}getPendingCount(){return 0}async saveMapCritical(e){return this.createMap(e)}destroy(){}}const ne=new mt;function ht(){const t=K(),e=le(),{user:r,workspaces:a}=T(),[n,l]=u.useState(!1),[o,i]=u.useState(""),[m,h]=u.useState(!1),[f,y]=u.useState(!1),[c,N]=u.useState({maps:[],nodes:[]}),C=u.useRef(null),S=u.useRef(new Map),M=u.useRef(""),b=u.useRef(null),F=u.useCallback(()=>{const d=t.pathname;return d==="/maps"?{title:"Meus Mapas",icon:Y,crumbs:["Dashboard","Meus Mapas"]}:d==="/profile"?{title:"Perfil",icon:V,crumbs:["Dashboard","Perfil"]}:d.includes("/map/")?{title:"Editor",icon:Y,crumbs:["Dashboard","Mapas","Editor"]}:{title:"Dashboard",icon:$e,crumbs:["Dashboard"]}},[t.pathname])(),J=u.useCallback(async d=>{try{b.current&&b.current.abort(),b.current=new AbortController;const g=d.trim().toLowerCase();if(!g){N({maps:[],nodes:[]}),y(!1);return}M.current=g,y(!0);const q=a[0]?.id;let _=[];try{if(q){const x=await he.list({workspace_id:q,limit:200,offset:0});_=Array.isArray(x.data)?x.data:[]}else _=ne.getCachedMaps()}catch{try{_=ne.getCachedMaps()}catch{_=[]}}Array.isArray(_)||(_=[]);const ye=_.filter(x=>{if(!x||typeof x!="object")return!1;const w=String(x.title||"").toLowerCase(),O=String(x.description||"").toLowerCase();return w.includes(g)||O.includes(g)}).map(x=>({id:x.id,title:x.title||"Mapa Sem Título",description:x.description||null,updated_at:x.updated_at||x.created_at||null})).slice(0,8),W=[];if(q&&_.length>0)try{(await Promise.all(_.map(async w=>{if(!w?.id)return{map:w,nodes:[]};if(S.current.has(w.id))return{map:w,nodes:S.current.get(w.id)||[]};try{const O=await rt.listByMap(w.id),v=Array.isArray(O.data)?O.data:[];return S.current.set(w.id,v),{map:w,nodes:v}}catch{return{map:w,nodes:[]}}}))).forEach(({map:w,nodes:O})=>{!w||!Array.isArray(O)||O.forEach(v=>{if(!v)return;const j=String(v.label??v.data?.label??"Nó").toLowerCase(),H=String(v.content??v.data?.content??v.data?.description??"").toLowerCase();`${j} ${H}`.includes(g)&&W.push({id:v.id,label:v.label??v.data?.label??"Nó",content:v.content??v.data?.content??v.data?.description??"",mapId:w.id,mapTitle:w.title||"Mapa"})})})}catch{}else!q&&_.length>0&&_.forEach(x=>{if(x?.id)try{const w=localStorage.getItem(`mindmap_nodes_${x.id}`);if(!w)return;const v=JSON.parse(w).nodes||[];if(!Array.isArray(v))return;v.forEach(j=>{if(!j)return;const H=String(j.data?.label??j.label??"Nó").toLowerCase(),Z=String(j.data?.content??j.content??j.data?.description??"").toLowerCase();`${H} ${Z}`.includes(g)&&W.push({id:j.id,label:j.data?.label??j.label??"Nó",content:j.data?.content??j.content??j.data?.description??"",mapId:x.id,mapTitle:x.title||"Mapa"})})}catch{}});const we=W.slice(0,12);M.current===g&&N({maps:ye,nodes:we})}catch{if(M.current!==d.toLowerCase())return;N({maps:[],nodes:[]})}finally{y(!1)}},[a]);u.useEffect(()=>{const d=o.trim();if(!d){N({maps:[],nodes:[]}),y(!1);return}const g=setTimeout(()=>{J(d)},300);return()=>clearTimeout(g)},[o,J]),u.useEffect(()=>{const d=g=>{(g.metaKey||g.ctrlKey)&&g.key==="k"&&(g.preventDefault(),h(!0),setTimeout(()=>{C.current?.querySelector("input")?.focus()},0)),g.key==="Escape"&&m&&(g.preventDefault(),h(!1),l(!1))};return window.addEventListener("keydown",d),()=>window.removeEventListener("keydown",d)},[m]),u.useEffect(()=>{const d=g=>{C.current&&!C.current.contains(g.target)&&(h(!1),l(!1))};return document.addEventListener("mousedown",d),()=>document.removeEventListener("mousedown",d)},[]);const B=u.useMemo(()=>c.maps.length+c.nodes.length,[c]);return s.jsxs("header",{className:"h-16 border-b border-white/[0.06] bg-gradient-to-r from-[#0A0E18] via-[#0D1323] to-[#0A0E18] backdrop-blur-xl flex items-center px-6 gap-6",children:[s.jsx(A.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{duration:.2},className:"flex items-center gap-2 min-w-fit",children:F.crumbs.map((d,g)=>s.jsxs("div",{className:"flex items-center gap-2",children:[g>0&&s.jsx(me,{className:"w-3.5 h-3.5 text-slate-600"}),s.jsx("span",{className:L("text-sm whitespace-nowrap",g===F.crumbs.length-1?"text-white font-semibold":"text-slate-500"),children:d})]},g))}),s.jsxs("div",{ref:C,className:"flex-1 max-w-xl mx-auto hidden md:block",children:[s.jsxs(A.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.3},className:L("relative flex items-center gap-3 px-4 py-2.5 rounded-full border-2 transition-all duration-200 group",n?"bg-gradient-to-r from-cyan-500/20 to-purple-500/20 border-cyan-500/70 shadow-xl shadow-cyan-500/20":"bg-white/[0.05] border-white/[0.12] hover:bg-white/[0.07] hover:border-white/[0.18]"),children:[s.jsx(te,{className:L("w-4 h-4 flex-shrink-0 transition-colors duration-200",n?"text-cyan-400":"text-slate-500 group-hover:text-slate-400")}),s.jsx("input",{type:"text",placeholder:"Procure mapas, nós, ideias...",value:o,onChange:d=>{i(d.target.value),d.target.value.trim()&&h(!0)},onFocus:()=>{l(!0),o.trim()&&h(!0)},onBlur:()=>{l(!1)},onKeyDown:d=>{d.key==="Escape"?(d.currentTarget.blur(),h(!1)):d.key==="Enter"&&c.maps.length>0&&(d.preventDefault(),e(`/map/${c.maps[0].id}`),h(!1),i(""))},className:"flex-1 bg-transparent text-sm text-white placeholder-slate-600 outline-none"}),o?s.jsx("button",{onClick:()=>{i(""),N({maps:[],nodes:[]})},className:"text-slate-500 hover:text-slate-300 transition-colors p-1 hover:bg-white/[0.08] rounded-md",title:"Limpar (Esc)",children:s.jsx(De,{className:"w-4 h-4"})}):s.jsx("kbd",{className:"hidden lg:inline text-xs text-slate-600 bg-white/[0.06] px-2 py-1 rounded border border-white/[0.1] font-mono",children:"⌘K"})]}),s.jsx(k,{children:m&&s.jsxs(A.div,{initial:{opacity:0,y:-8,scale:.96},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-8,scale:.96},transition:{duration:.15},className:"absolute top-14 left-0 right-0 rounded-2xl border border-white/[0.1] bg-[#0D1323]/98 backdrop-blur-2xl shadow-2xl shadow-black/50 overflow-hidden z-50 max-h-[600px] flex flex-col",children:[s.jsxs("div",{className:"px-5 py-4 border-b border-white/[0.05] flex items-center justify-between flex-shrink-0 bg-gradient-to-r from-white/[0.02] to-transparent",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-slate-600 font-bold uppercase tracking-wider",children:f?"🔍 Buscando...":B>0?`${B} resultado(s)`:"✨ Pronto"}),o&&s.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["para"," ",s.jsxs("span",{className:"text-white font-medium",children:["“",o,"”"]})]})]}),f&&s.jsx(Ue,{className:"w-4 h-4 animate-spin text-cyan-400"})]}),s.jsxs("div",{className:"overflow-y-auto flex-1",children:[!o&&s.jsxs("div",{className:"p-8 text-center",children:[s.jsx("div",{className:"inline-flex items-center justify-center w-12 h-12 rounded-full bg-gradient-to-br from-cyan-500/15 to-purple-500/15 mb-3",children:s.jsx(te,{className:"w-6 h-6 text-slate-600"})}),s.jsxs("p",{className:"text-sm text-slate-500 mt-2",children:["Digite para buscar em seus ",s.jsx("br",{}),"mapas, nós e ideias"]})]}),o&&!f&&B===0&&s.jsxs("div",{className:"p-8 text-center",children:[s.jsxs("p",{className:"text-sm text-slate-600",children:["Nenhum resultado para"," ",s.jsxs("span",{className:"text-white font-medium",children:["“",o,"”"]})]}),s.jsx("p",{className:"text-xs text-slate-700 mt-2",children:"Tente outro termo de busca"})]}),c.maps.length>0&&s.jsxs("div",{className:"border-b border-white/[0.05]",children:[s.jsx("div",{className:"px-5 pt-4 pb-2",children:s.jsxs("p",{className:"flex items-center gap-2 text-xs font-bold uppercase tracking-wider text-slate-600",children:[s.jsx(ze,{className:"w-3.5 h-3.5 text-cyan-400"}),"Mapas"," ",s.jsxs("span",{className:"text-slate-700 font-normal",children:["(",c.maps.length,")"]})]})}),s.jsx("div",{className:"space-y-0.5 px-3 pb-3",children:c.maps.map(d=>s.jsx("button",{onClick:()=>{X.cleanupAllOverlays(),e(`/map/${d.id}`),h(!1),i("")},className:"w-full text-left px-3 py-2.5 rounded-lg hover:bg-white/[0.06] active:bg-white/[0.1] transition-colors group",children:s.jsxs("div",{className:"flex items-start justify-between gap-2",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-sm text-white font-medium group-hover:text-cyan-300 transition-colors truncate",children:d.title}),d.description&&s.jsx("p",{className:"text-xs text-slate-500 line-clamp-1 mt-0.5",children:d.description})]}),d.updated_at&&s.jsx("span",{className:"text-xs text-slate-600 flex-shrink-0",children:ct(d.updated_at)})]})},d.id))})]}),c.nodes.length>0&&s.jsxs("div",{children:[s.jsx("div",{className:"px-5 py-3 border-t border-white/[0.05]",children:s.jsxs("p",{className:"flex items-center gap-2 text-xs font-bold uppercase tracking-wider text-slate-600",children:[s.jsx(Fe,{className:"w-3.5 h-3.5 text-purple-400"}),"Nós"," ",s.jsxs("span",{className:"text-slate-700 font-normal",children:["(",c.nodes.length,")"]})]})}),s.jsx("div",{className:"space-y-0.5 px-3 pb-3",children:c.nodes.map(d=>s.jsx("button",{onClick:()=>{X.cleanupAllOverlays(),e(`/map/${d.mapId}?node=${d.id}&q=${encodeURIComponent(o)}`),h(!1),i("")},className:"w-full text-left px-3 py-2.5 rounded-lg hover:bg-white/[0.06] active:bg-white/[0.1] transition-colors group",children:s.jsx("div",{className:"flex items-start justify-between gap-2",children:s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-sm text-white font-medium group-hover:text-purple-300 transition-colors truncate",children:d.label}),d.content&&s.jsx("p",{className:"text-xs text-slate-500 line-clamp-1 mt-0.5",children:d.content}),s.jsxs("p",{className:"text-xs text-slate-700 mt-1",children:["em ",s.jsx("span",{className:"text-slate-500",children:d.mapTitle})]})]})})},d.id))})]})]})]})})]}),s.jsx("div",{className:"flex-1"}),s.jsxs("div",{className:"hidden lg:flex items-center gap-2 px-3 py-1.5 rounded-lg bg-white/[0.03] border border-white/[0.06] ml-auto",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-400 shadow-sm shadow-emerald-400/50"}),s.jsx("span",{className:"text-xs text-slate-500 font-medium",children:"Online"})]}),s.jsxs("div",{className:"flex items-center gap-2.5 pl-3 pr-1 border-l border-white/[0.06]",children:[s.jsxs("div",{className:"hidden lg:block text-right",children:[s.jsx("p",{className:"text-xs font-semibold text-white leading-tight truncate max-w-[100px]",children:r?.display_name||"Usuário"}),s.jsx("p",{className:"text-[10px] text-slate-600",children:"Perfil"})]}),s.jsx(pe,{url:r?.avatar_url,displayName:r?.display_name,size:"md"})]})]})}const pt={initial:{opacity:0,y:6},animate:{opacity:1,y:0,transition:{duration:.3,ease:[.25,.1,.25,1]}},exit:{opacity:0,y:-4,transition:{duration:.15}}};function ft({children:t}){const[e,r]=de.useState(!1),a=K();return u.useEffect(()=>{document.querySelectorAll("[data-overlay]").forEach(i=>{i.textContent||i.remove()}),document.body.style.overflow="",document.documentElement.style.overflow="";const l=document.body;window.getComputedStyle(l).overflow==="hidden"&&(l.style.overflow="")},[a.pathname]),s.jsxs("div",{className:"flex h-screen bg-[#060910] overflow-hidden",children:[s.jsx(ut,{collapsed:e,onCollapsedChange:r}),s.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[s.jsx(ht,{}),s.jsx("main",{className:"flex-1 overflow-y-auto overflow-x-hidden",children:s.jsx(k,{mode:"wait",children:s.jsx(A.div,{variants:pt,initial:"initial",animate:"animate",exit:"exit",className:"min-h-full",children:t||s.jsx(ue,{})},a.pathname)})})]})]})}function gt(){return s.jsx("div",{className:"min-h-screen bg-[#080C14]",children:s.jsx(ue,{})})}const xt=u.lazy(()=>R(()=>import("./LoginPage-B-T9pPJV.js"),__vite__mapDeps([0,1,2,3,4,5,6,7])).then(t=>({default:t.LoginPage}))),yt=u.lazy(()=>R(()=>import("./DashboardPage-BgfHRYWq.js"),__vite__mapDeps([8,1,9,5,6,7])).then(t=>({default:t.DashboardPage}))),wt=u.lazy(()=>R(()=>import("./NeuralMapEditorPage-D37jK9am.js"),__vite__mapDeps([10,1,11,7,12,6,13,5,14]))),bt=u.lazy(()=>R(()=>import("./KanbanPage-BKKd0GTi.js"),__vite__mapDeps([15,1])).then(t=>({default:t.KanbanPage}))),vt=u.lazy(()=>R(()=>import("./NotFoundPage-CrDFmOJw.js"),__vite__mapDeps([16,1,2,3,6,7,5])).then(t=>({default:t.NotFoundPage}))),jt=u.lazy(()=>R(()=>import("./MapsPage-CsqiSI5B.js"),__vite__mapDeps([17,1,9,14,5,6,7])).then(t=>({default:t.MapsPage}))),Nt=u.lazy(()=>R(()=>import("./TasksPage-B4p1IZRf.js"),__vite__mapDeps([18,1])).then(t=>({default:t.TasksPage}))),St=u.lazy(()=>R(()=>import("./ProfilePage-D3do1lGl.js"),__vite__mapDeps([19,1,2,3,6,5,4,7])).then(t=>({default:t.ProfilePage})));function _t(){return s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-900",children:s.jsx("div",{className:"w-10 h-10 border-4 border-cyan-500/30 border-t-cyan-400 rounded-full animate-spin"})})}function Et({children:t}){return ot(),s.jsx(s.Fragment,{children:t})}function oe({children:t}){const{isAuthenticated:e,isLoading:r}=T();return r?s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-900",children:s.jsx("div",{className:"w-10 h-10 border-4 border-purple-500/30 border-t-purple-500 rounded-full animate-spin"})}):e?s.jsx(s.Fragment,{children:t}):s.jsx(Q,{to:"/login",replace:!0})}function Ct({children:t}){const{isAuthenticated:e,isLoading:r}=T();return r?s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-900",children:s.jsx("div",{className:"w-10 h-10 border-4 border-purple-500/30 border-t-purple-500 rounded-full animate-spin"})}):e?s.jsx(Q,{to:"/dashboard",replace:!0}):s.jsx(s.Fragment,{children:t})}function At(){const t=T(r=>r.initialize),e=K();return u.useEffect(()=>{t(),ae("app_opened",{source:"app-bootstrap"})},[t]),u.useEffect(()=>{if(e.pathname.startsWith("/map/")){const a=e.pathname.split("/")[2];ae("map_opened",{mapId:a,source:"route-change"})}const r=setTimeout(()=>{X.cleanupAllOverlays()},200);return()=>clearTimeout(r)},[e.pathname]),s.jsxs(lt,{children:[s.jsx(je,{}),s.jsx(Et,{children:s.jsx(u.Suspense,{fallback:s.jsx(_t,{}),children:s.jsxs(Ne,{children:[s.jsx(E,{element:s.jsx(gt,{}),children:s.jsx(E,{path:"/login",element:s.jsx(Ct,{children:s.jsx(xt,{})})})}),s.jsx(E,{path:"/map/:mapId",element:s.jsx(oe,{children:s.jsx(wt,{})})}),s.jsxs(E,{element:s.jsx(oe,{children:s.jsx(ft,{})}),children:[s.jsx(E,{path:"/dashboard",element:s.jsx(yt,{})}),s.jsx(E,{path:"/maps",element:s.jsx(jt,{})}),s.jsx(E,{path:"/tasks",element:s.jsx(Nt,{})}),s.jsx(E,{path:"/kanban",element:s.jsx(bt,{})}),s.jsx(E,{path:"/profile",element:s.jsx(St,{})})]}),s.jsx(E,{path:"/",element:s.jsx(Q,{to:"/login",replace:!0})}),s.jsx(E,{path:"*",element:s.jsx(vt,{})})]})})})]})}const Ot="A listener indicated an asynchronous response by returning true";let ie=0;const z=new Set;function fe(t){return t instanceof Error?t.message:typeof t=="string"?t:typeof t=="object"&&t!==null&&"message"in t?String(t.message||"Unknown error"):"Unknown error"}function ge(t){return t.includes(Ot)}function xe(t){const e=Date.now();e-ie>8e3&&(ce.error("Encontramos um erro inesperado. Sua sessão foi preservada.",{duration:3500}),ie=e),z.size>250&&z.clear(),z.add(t)}window.addEventListener("error",t=>{const e=fe(t.error??t.message);if(e){if(ge(e)){t.preventDefault();return}z.has(e)||(I.error("Erro global não tratado (window.error)",{message:e,filename:t.filename,lineno:t.lineno,colno:t.colno}),t.error,t.filename,t.lineno,t.colno,void 0),xe(e)}});window.addEventListener("unhandledrejection",t=>{const e=fe(t.reason);if(e){if(ge(e)){t.preventDefault();return}z.has(e)||(I.error("Promise rejeitada sem tratamento (unhandledrejection)",{message:e,reason:t.reason}),t.reason,void 0),xe(e)}});const Rt=new Se({defaultOptions:{queries:{staleTime:1e3*60*5,retry:1,refetchOnWindowFocus:!1}}});_e.createRoot(document.getElementById("root")).render(s.jsx(de.StrictMode,{children:s.jsx(Ee,{client:Rt,children:s.jsxs(Ce,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:[s.jsx(At,{}),s.jsx(Ae,{position:"bottom-right",toastOptions:{duration:3500,style:{background:"hsl(var(--card))",color:"hsl(var(--card-foreground))",border:"1px solid hsl(var(--border))"},success:{duration:3500,iconTheme:{primary:"#10B981",secondary:"white"}},error:{iconTheme:{primary:"#EF4444",secondary:"white"}}}})]})})}));export{R as _,re as a,he as b,L as c,ct as f,He as g,ne as m,rt as n,U as s,ae as t,T as u};

