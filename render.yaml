services:
  - type: web
    name: mindmap-hub-api
    runtime: node
    plan: starter
    region: ohio

    buildCommand: npm install && npm run build:backend
    startCommand: cd backend && node dist/index.js

    healthCheckPath: /health

    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: '3001'
      - key: ALLOW_PROFILE_AUTH
        value: 'false'
      - key: DEFAULT_WORKSPACE_ID
        value: '11111111-1111-1111-1111-111111111111'
      - key: CLAUDE_MODEL
        value: claude-haiku-4-5-20251001
      - key: CLAUDE_MAX_TOKENS
        value: '8192'
      - key: CLAUDE_TEMPERATURE
        value: '0.9'
      - key: RATE_LIMIT_WINDOW_MS
        value: '60000'
      - key: RATE_LIMIT_MAX
        value: '100'
      - key: AI_RATE_LIMIT_MAX
        value: '10'
      - key: FRONTEND_URL
        value: https://mindmap-hub.vercel.app
      - key: CORS_ORIGIN
        value: https://mindmap-hub.vercel.app

      # Secrets - configure these in the Render dashboard
      - key: SUPABASE_URL
        sync: false
      - key: SUPABASE_ANON_KEY
        sync: false
      - key: SUPABASE_SERVICE_ROLE_KEY
        sync: false
      - key: CLAUDE_API_KEY
        sync: false
